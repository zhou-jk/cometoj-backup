<html>

<head>
	<meta charset="utf-8" />
	<link rel="icon" href="../image/favicon.ico" sizes="32x32" />
	<link rel="icon" href="../image/favicon.ico" sizes="192x192" />
	<link rel="stylesheet" type="text/css" href="../static/semantic.min.css">
	<script src="../static/jquery.min.js" type="text/javascript"></script>
	<script src="../static/semantic.min.js" type="text/javascript"></script>
	<title>[NOI2018Day2-C]多边形</title>
	<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['$$$', '$$$']]
  },
  svg: {
    fontCache: 'global'
  }
};
	</script>
	<script type="text/javascript" id="MathJax-script" async src="../static/es5/tex-svg.js"></script>
</head>

<body>
	<div class="ui three item menu"><a class="header item" href="../index.html"><img src="../image/favicon.ico"> Comet OJ</a>
	</div>
	<div class="ui main container">
		<div class="ui center aligned grid">
			<div class="row">
				<h1 class="ui header">C0407 [NOI2018Day2-C]多边形</h1>
			</div>
				<div class="row" style="margin-top: -15px"><span class="ui label">内存限制：512 MB</span> <span class="ui label">时间限制：12000 ms</span></div>
		</div>
		<div class="ui grid">
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">题目描述</h4>
					<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<p>久莲是一个喜欢出题的女孩子。</p><p>在今年的 World Final 结束以后，久莲特别喜欢计算几何，于是她打算在 NOI 的考场上也出一个计算几何：这是一道只有题目名字和计算几何相关的题目。</p><p>首先，久莲给出了一棵$n(n≥2)$个节点的有根树 T，根节点编号为1。定义叶子节点为除了根以外所有度数恰好为1的节点。下图是一个树 T 的例子，其中叶子节点集合为{3,4,5}。</p><p><img alt="屏幕快照 2019-06-03 下午4.27.55.png" src="../upload/56d6ddf44c.png" width="150" height="166.5"><br></p><p>接着通过这棵树，久莲构造了一个序列A：</p><ul><li>从根节点开始深度优先遍历整棵树，遍历时按照编号从小到大的顺序来访问孩子，这样可以得到一个树T的 DFS 序。</li><li>接着按照在 DFS 序中的出现顺序从前往后，久莲把所有叶子节点排成一排得到了一个序列A。</li></ul><p>更进一步地，通过序列 A，久莲定义了两个叶子节点$u,v$的距离$d(u,v)$：假设$u$在A中是第$i$个元素，$v$是第$j$个元素，则$d(u,v)=min(∣i−j∣,∣A∣−∣i−j∣)$。其中$∣A∣$为序列的长度，即T的叶子个数，$i,j$指的是出现的位置，从1开始计数。</p><p>上面的例子中，序列A为$[4,5,3]$，其中$d(3,5)=d(3,4)=d(4,5)=1$，3,4,5的出现位置分别为3,1,2。</p><p>最后，久莲给出了一个参数K，利用这棵有根树T和序列A，我们可以构造一张n个点的<strong>无重边无自环</strong>的无向图G：两个不同的点$u,v$之间有边当且仅当它们满足下列条件中的至少一个：</p><ul><li>在树T中存在连接$u,v$的边。</li><li>在树T中$u,v$都是叶子节点且$d(u,v)≤K$。</li></ul><p>当K=1或2时，上面的例子得到的图G都如下图所示：</p><p><img alt="屏幕快照 2019-06-03 下午4.42.06.png" src="../upload/8d410fed23.png" width="150" height="174.75"><br></p><p>现在久莲想让你来计算一下G中不同的哈密尔顿回路数量有多少条，答案可能很大，请对998244353取模后输出。</p><p>下面是一些补充定义：</p><ul><li>无重边无自环的无向图G的一条哈密尔顿回路H是G中边的一个子集，其中每一个点恰好有两条不同的相邻边在H中，且任意两个点都可以通过H中的边直接或间接到达。</li><li>无重边无自环的无向图G的两条哈密尔顿回路$H_1,H_2$是不同的当且仅当存在一条边e使得e在$H_1$中且不在$H_2$中。</li></ul>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输入格式</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>第一行输入两个整数n,K，表示树T的点数以及久莲选定的参数K。</p><p>第二行输入n−1个整数$f_i(1≤f_i≤i)$，其中$f_i$表示树T上存在边$(f_i,i+1)$。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输出</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>输出一行一个整数，表示哈密尔顿回路数量对998244353取模后的结果。<br></p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">样例</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<h4>样例输入 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>5 1
1 1 2 2</span></div></code></pre>
							</div>
							<h4>样例输出 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>2</span></div></code></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">提示</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>【样例解释】</p><p>两条哈密尔顿回路经过节点的顺序分别为(1,2,4,5,3)和(1,2,5,4,3)。<br></p><p>【子任务】</p><p><img alt="屏幕快照 2019-06-03 下午4.54.34.png" src="../upload/dfe5fb30d1.png" width="500" height="340.2903811252269"><br></p><p>其中性质A为保证树上所有节点至多有两个孩子。</p><p>对于所有的数据，保证$1 \le f_i \le i, 2 \le n \le 1000$。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>