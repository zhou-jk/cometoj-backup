<html>

<head>
	<meta charset="utf-8" />
	<link rel="icon" href="../image/favicon.ico" sizes="32x32" />
	<link rel="icon" href="../image/favicon.ico" sizes="192x192" />
	<link rel="stylesheet" type="text/css" href="../static/semantic.min.css">
	<script src="../static/jquery.min.js" type="text/javascript"></script>
	<script src="../static/semantic.min.js" type="text/javascript"></script>
	<title>[JSOI2010]蔬菜庆典</title>
	<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\(', '\)']]
  },
  svg: {
    fontCache: 'global'
  }
};
	</script>
	<script type="text/javascript" id="MathJax-script" async src="../static/es5/tex-svg.js"></script>
</head>

<body>
	<div class="ui three item menu"><a class="header item" href="../index.html"><img src="../image/favicon.ico"> Comet OJ</a>
	</div>
	<div class="ui main container">
		<div class="ui center aligned grid">
			<div class="row">
				<h1 class="ui header">C1233 [JSOI2010]蔬菜庆典</h1>
			</div>
				<div class="row" style="margin-top: -15px"><span class="ui label">内存限制：256 MB</span> <span class="ui label">时间限制：1000 ms</span></div>
		</div>
		<div class="ui grid">
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">题目描述</h4>
					<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<p>jyy 在火星上找到一片埋有宝藏的岛，并且带走了一些宝藏。之后 jyy 被火星人发现偷宝藏，抓了起来。火星人打算吃掉 jyy，除非 jyy 能在火星年度蔬菜庆典的游戏中赢得足够多的火星币，来支付他带走宝藏的费用。</p><p>游戏在蔬菜广场上进行。首先放进广场的是一个巨大的转基因南瓜，接着各种其他巨大的蔬菜被陆续拖进广场，连同大南瓜一共 $N$ 个 $(1\le N \le 200000)$。方便起见，我们把蔬菜按照放入广场的时间顺序从 $1...N$ 编号。第 $i$ 个放入的蔬菜 $(i \ge 2)$ 会用一根绳子和先前放入的某个蔬菜 $p_i(1 \le p_i &lt; i)$ 连接起来。按照火星人的说法，蔬菜 $i$ 是蔬菜 $p_i$ 的 Dlihc，蔬菜 $p_i$ 是蔬菜 $i$ 的 Tnerap。jyy 立即看出，一开始的大南瓜没有 Tnerap，后来的每个蔬菜都恰好有一个 Tnerap；每个蔬菜可能有一个或多个 Dlihc，也可能没有。$N$ 个蔬菜全部在广场上安置好后，火星人在每个蔬菜上贴一张纸条，蔬菜 $i$ 的纸条上写着一个整数 $v_i(-10000000 \le v_i \le 10000000)$，表示这个蔬菜的价钱。</p><p>游戏一个接一个地进行着，在整个晚会将要结束时，jyy 终于等到了适合自己的那一个（你不能指望有恐高症的 jyy 会在蔬菜间玩走钢丝，尽管那样能有丰富的报酬）。游戏规则是：游戏者（也就是 jyy 啦）每次可以选择任意一个既有 Dlihc 又有 Tnerap 的蔬菜 $i$，将它的价钱 $v_i$ 改为 $v_p+v_c-v_i$。其中 $p$ 表示蔬菜 $i$ 的 Tnerap 的编号，$c$ 表示蔬菜 $i$ 的任意一个 Dlihc 的编号。火星人给的时间比较宽裕，足够 jyy 进行任意多次操作。当 jyy 决定不再操作时，游戏结束。之后所有巨型蔬菜将被火星政府按蔬菜上的标价收购，卖菜所得的钱归 jyy 所有，用以支付他的债务。</p><p>jyy 想知道，他最多能把这些蔬菜卖出多少钱，或者他能通过一系列操作使得蔬菜的总价无限制地增大。请你帮助 jyy 解决这个问题。</p>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输入格式</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>输入有多组数据。每组数据的格式为：</p><p>第 $1$ 行是一个整数 $N$，表示广场上蔬菜的总个数。</p><p>第 $2...N+1$ 行，每行两个整数，第 $i+1$ 行的两个整数位 $p_i,v_i$。意义如题中所述。$p_1$ 设为 $-1$。</p><p>当 $N=0$ 时，表示输入结束。</p><p>保证每个测试点中 $N$ 的总和不超过 $200000$。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输出</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>对于每组数据，输出一行。若蔬菜的总价能无限制增大，输出 "+inf"（不含引号）。否则输出一个整数，表示所有蔬菜的最大总价。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">样例</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<h4>样例输入 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>5
-1 3
1 2
1 1
3 2
3 2
5
-1 3
1 2
1 1
3 2
3 3
0</span></div></code></pre>
							</div>
							<h4>样例输出 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>13
+inf</span></div></code></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">提示</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>