<html>

<head>
	<meta charset="utf-8" />
	<link rel="icon" href="../image/favicon.ico" sizes="32x32" />
	<link rel="icon" href="../image/favicon.ico" sizes="192x192" />
	<link rel="stylesheet" type="text/css" href="../static/semantic.min.css">
	<script src="../static/jquery.min.js" type="text/javascript"></script>
	<script src="../static/semantic.min.js" type="text/javascript"></script>
	<title>[CTSC2019]氪金手游</title>
	<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['$$$', '$$$']]
  },
  svg: {
    fontCache: 'global'
  }
};
	</script>
	<script type="text/javascript" id="MathJax-script" async src="../static/es5/tex-svg.js"></script>
</head>

<body>
	<div class="ui three item menu"><a class="header item" href="../index.html"><img src="../image/favicon.ico"> Comet OJ</a>
	</div>
	<div class="ui main container">
		<div class="ui center aligned grid">
			<div class="row">
				<h1 class="ui header">C0154 [CTSC2019]氪金手游</h1>
			</div>
				<div class="row" style="margin-top: -15px"><span class="ui label">内存限制：512 MB</span> <span class="ui label">时间限制：1000 ms</span></div>
		</div>
		<div class="ui grid">
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">题目描述</h4>
					<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<p>小刘同学是一个喜欢氪金手游的男孩子。</p><p>他最近迷上了一个新游戏，游戏的内容就是不断地抽卡。现在已知：</p><ul><li>卡池里总共有 $N$ 种卡，第 $i$ 种卡有一个权值 $W_i$​，小刘同学不知道 $W_i$​ 具体的值是什么。但是他通过和网友交流，他了解到 $W_i$ ​服从一个分布。</li><li>具体地，对每个 $i$，小刘了解到三个参数 $p_{i,1},p_{i,2},p_{i,3}$​，$W_i$​ 将会以 $p_{i,j}$ ​的概率取值为 $j$，保证 $p_{i,1}+p_{i,2}+p_{i,3}=1$。</li></ul><p>小刘开始玩游戏了，他每次会氪一元钱来抽一张卡，其中抽到卡 $i$ 的概率为：$\frac{W_i}{\sum_jW_j}$</p><p>小刘会不停地抽卡，直到他手里集齐了全部 $N$ 种卡。</p><p>抽卡结束之后，服务器记录下来了小刘第一次得到每张卡的时间 $T_i$。游戏公司在这里设置了一个彩蛋：公司准备了 $N−1$ 个二元组 $(u_i,v_i)$，如果对任意的 $i$，成立 $T_{u_i}&lt;T_{v_i}$，那么游戏公司就会认为小刘是极其幸运的，从而送给他一个橱柜的手办作为幸运大奖。</p><p>游戏公司为了降低获奖概率，它准备的这些 $(u_i,v_i)$ 满足这样一个性质：对于任意的 $∅≠S⊊\{1,2,…,N\}$，总能找到 $(u_i,v_i)$ 满足：$u_i∈S,v_i∉S$ 或者 $u_i∉S,v_i∈S$。</p><p>请你求出小刘同学能够得到幸运大奖的概率，可以保证结果是一个有理数，请输出它对 $998244353$ 取模的结果。</p>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输入格式</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>第一行一个整数 $N$，表示卡的种类数。</p><p>接下来 $N$ 行，每行三个整数 $a_{i,1},a_{i,2},a_{i,3}$，而题目给出的 $p_{i,j}=\frac{a_{i,j}}{a_{i,1}+a_{i,2}+a_{i,3}}$。</p><p>接下来 $N−1$ 行，每行两个整数 $u_i,v_i$，描述一个二元组（意义见题目描述）。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输出</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>输出一行一个整数，表示所求概率对 $998244353$ 取模的结果。<br></p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">样例</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<h4>样例输入 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>2
0 0 1
1 1 0
1 2</span></div></code></pre>
							</div>
							<h4>样例输出 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>524078286</span></div></code></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">提示</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>【样例 1 解释】</p><p>$W_2$ 以 $\frac{1}{2}$ 的概率取 $1$ 或者 $2$：</p><ul><li>如果 $W_2=1$，那么 $T_1&lt;T_2$ 的概率为 $\frac{3}{4}$。</li><li>否则 $W_2=2$，$T_1&lt;T_2$ 的概率为 $\frac{3}{5}$。</li></ul><p>综合所有情况答案为 $\frac{1}{2}(\frac{3}{4}+\frac{3}{5})=\frac{27}{40}$，你可以验证它对 $998244353$ 取模的结果确实是所给答案。</p><p>【测试数据约定】</p><p>对于全部的测试数据，保证 $N≤1000$，$a_{i,j}≤10^6$。</p><ul><li>20分的数据，$N≤15$。</li><li>15分的数据，$N≤200$，且每个限制保证 $|u_i−v_i|=1$。</li><li>20分的数据，$N≤1000$，且每个限制保证 $|u_i−v_i|=1$。</li><li>15分的数据，$N≤200$。</li><li>30分的数据，无特殊限制。</li></ul>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>