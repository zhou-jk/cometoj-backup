<html>

<head>
	<meta charset="utf-8" />
	<link rel="icon" href="../image/favicon.ico" sizes="32x32" />
	<link rel="icon" href="../image/favicon.ico" sizes="192x192" />
	<link rel="stylesheet" type="text/css" href="../static/semantic.min.css">
	<script src="../static/jquery.min.js" type="text/javascript"></script>
	<script src="../static/semantic.min.js" type="text/javascript"></script>
	<title>[CEOI2015Day1] Calvinball championship</title>
	<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\(', '\)']]
  },
  svg: {
    fontCache: 'global'
  }
};
	</script>
	<script type="text/javascript" id="MathJax-script" async src="../static/es5/tex-svg.js"></script>
</head>

<body>
	<div class="ui three item menu"><a class="header item" href="../index.html"><img src="../image/favicon.ico"> Comet OJ</a>
	</div>
	<div class="ui main container">
		<div class="ui center aligned grid">
			<div class="row">
				<h1 class="ui header">C1718 [CEOI2015Day1] Calvinball championship</h1>
			</div>
				<div class="row" style="margin-top: -15px"><span class="ui label">内存限制：64 MB</span> <span class="ui label">时间限制：1000 ms</span></div>
		</div>
		<div class="ui grid">
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">题目描述</h4>
					<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<p>In addition to CEOI and ice hockey championship, Czech Republic hosts this year also a Calvinball championship. We will not go into the quasiexistent rules of Calvinball, and instead focus on the team selection procedure.</p><p>A game of Calvinball is played by $n$ players with distinct names, divided into any number of non-empty teams. To record the teams, the following convention is employed. First, the player in each team with the lexicographically smallest name is chosen as the captain of the team. Then, the teams are sorted lexicographically by the names of their captains and numbered by consecutive integers starting from $1$. Finally, the players are listed in the lexicographic order together with their team numbers.</p><p>For example, if there are three teams, one consisting of Calvin, Hobbes, and Susie, one consisting of Tom and Jerry, and one consisting only of Batman, the record would look like this:</p><p>$\begin{array}{lc}Batman &amp; 1 \\Calvin &amp; 2 \\Hobbes &amp; 2 \\Jerry &amp; 3 \\Susie &amp; 2 \\Tom &amp; 3 \\\end{array}$</p><p>The same players play each day of the championship, but each time, different teams are chosen. As the players are the same each day, we can for briefness omit their names from the listing and record the teams only as the sequence of team numbers (1 2 2 3 2 3 in the above example). The championship ends when all the possible team choices were tried out.</p><p>As there are many possible team choices, deciding the teams for each day used to be quite confusing. This year, the International Calvinball Disorganization decided that the team selections will be made according to the lexicographic ordering of the sequences that represent them. So, the first day, all players will be on the same team (sequence 1 1 1 1 1 1), the second day everybody plays agains Tom (sequence 1 1 1 1 1 2), . . . , and on the last day, everybody plays against everybody (sequence 1 2 3 4 5 6).</p><p>For a given record of teams, determine on which day of the tournament it will be used. Output the number modulo $1 000 007$.</p><p>Please note that the names of the players in the example are for the sake of explanation only and they play no role in the actual task.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输入格式</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>A description of the teams is read from the standard input. The first line of the input contains a positive integer $n(1 ≤ n ≤ 10 000)$. The second line of the input contains $n$ positive integers separated by spaces, giving the description of teams as specified in the task statement.</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输出</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>To the standard output, write a single integer giving the number of the day of the championship on which the given team selection will be used modulo $1 000 007$. The first day of the championship has number $1$.</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">样例</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<h4>样例输入 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>3
1 2 2</span></div></code></pre>
							</div>
							<h4>样例输出 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>4</span></div></code></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">提示</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>There are 10 groups of tests, each of them worth 10 points. The upper bound on $n$ in each group of tests is as follows.</p><p><img alt="image.png" src="../upload/9fa3e0d728.png" width="317"><br></p><p>Additionally, the 4-th and the 8-th test group consists of only one test, in which the sequence describing the teams is 1 2&nbsp; 3 ... n (i.e., it describes the situation on the last day of the championship, when everybody plays against everybody).<br></p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>