<html>

<head>
	<meta charset="utf-8" />
	<link rel="icon" href="../image/favicon.ico" sizes="32x32" />
	<link rel="icon" href="../image/favicon.ico" sizes="192x192" />
	<link rel="stylesheet" type="text/css" href="../static/semantic.min.css">
	<script src="../static/jquery.min.js" type="text/javascript"></script>
	<script src="../static/semantic.min.js" type="text/javascript"></script>
	<title>[CCPC2017秦皇岛站-A] Balloon Robot</title>
	<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['$$$', '$$$']]
  },
  svg: {
    fontCache: 'global'
  }
};
	</script>
	<script type="text/javascript" id="MathJax-script" async src="../static/es5/tex-svg.js"></script>
</head>

<body>
	<div class="ui three item menu"><a class="header item" href="../index.html"><img src="../image/favicon.ico"> Comet OJ</a>
	</div>
	<div class="ui main container">
		<div class="ui center aligned grid">
			<div class="row">
				<h1 class="ui header">C1747 [CCPC2017秦皇岛站-A] Balloon Robot</h1>
			</div>
				<div class="row" style="margin-top: -15px"><span class="ui label">内存限制：64 MB</span> <span class="ui label">时间限制：1000 ms</span></div>
		</div>
		<div class="ui grid">
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">题目描述</h4>
					<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<p>The 2017 China Collegiate Programming Contest Qinhuangdao Site is coming! There will be $n$ teams participating in the contest, and the contest will be held on a huge round table with $m$ seats numbered from $1$ to $m$ in clockwise order around it. The $i$-­th team will be seated on the $s_i$-­th seat.</p><p>BaoBao, an enthusiast for competitive programming, has made $p$ predictions of the contest result before the contest. Each prediction is in the form of $(a_i,b_i)$, which means the $a_i$-­th team solves a problem during the  $b_i$-th time unit.</p><p>As we know, when a team solves a problem, a balloon will be rewarded to that team. The participants will be unhappy if the balloons take almost centuries to come. If a team solves a problem during the $t_a$-­th time unit, and the balloon is sent to them during the $t_b$-­th time unit, then the unhappiness of the team will increase by $t_b-t_a$. In order to give out balloons timely, the organizers of the contest have bought a balloon robot.</p><p>At the beginning of the contest (that is to say, at the beginning of the 1st time unit), the robot will be put on the $k$-­th seat and begin to move around the table. If the robot moves past a team which has won themselves some balloons after the robot's last visit, it will give all the balloons they deserve to the team. During each unit of time, the following events will happen in order:</p><ol><li>The robot moves to the next seat. That is to say, if the robot is currently on the $i$-­th ($1 \le i &lt; m$) seat, it will move to the $(i+1)$-­th seat; If the robot is currently on the $m$-th seat, it will move to the 1st seat.</li><li>The participants solve some problems according to BaoBao's prediction.</li><li>The robot gives out balloons to the team seated on its current position if needed.</li></ol><p>BaoBao is interested in minimizing the total unhappiness of all the teams. Your task is to select the starting position $k$ of the robot and calculate the minimum total unhappiness of all the teams according to BaoBao's predictions.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输入格式</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>There are multiple test cases. The first line of the input contains an integer $T$, indicating the number of test cases. For each test case:</p><p>The first line contains three integers $n$, $m$ and $p$ $(1 \le n \le 10^5, n \le m \le 10^9, 1 \le p \le 10^5 )$, indicating the number of participating teams, the number of seats and the number of predictions.</p><p>The second line contains $n$ integers $s_1,s_2,...,s_n$  $(1 \le s_i \le m$, and $s_i \ne s_j$ for all $i \ne j )$, indicating the seat number of each team.</p><p>The following $p$ lines each contains two integers $a_i$ and $b_i$ $(1\le a_i \le n, 1\le b_i \le 10^9)$, indicating that the $a_i$-­th team solves a problem at time $b_i$ according to BaoBao's predictions.</p><p>It is guaranteed that neither the sum of $n$ nor the sum of $p$ over all test cases will exceed $5 \times 10^5$.</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输出</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>For each test case output one integer, indicating the minimum total unhappiness of all the teams according to BaoBao's predictions.</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">样例</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<h4>样例输入 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>4
2 3 3
1 2
1 1
2 1
1 4
2 3 5
1 2
1 1
2 1
1 2
1 3
1 4
3 7 5
3 5 7
1 5
2 1
3 3
1 5
2 5
2 100 2
1 51
1 500
2 1000</span></div></code></pre>
							</div>
							<h4>样例输出 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>1
4
5
50</span></div></code></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">提示</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>