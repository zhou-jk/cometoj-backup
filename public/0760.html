<html>

<head>
	<meta charset="utf-8" />
	<link rel="icon" href="../image/favicon.ico" sizes="32x32" />
	<link rel="icon" href="../image/favicon.ico" sizes="192x192" />
	<link rel="stylesheet" type="text/css" href="../static/semantic.min.css">
	<script src="../static/jquery.min.js" type="text/javascript"></script>
	<script src="../static/semantic.min.js" type="text/javascript"></script>
	<title>[HNOI2015]亚瑟王</title>
	<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\(', '\)']]
  },
  svg: {
    fontCache: 'global'
  }
};
	</script>
	<script type="text/javascript" id="MathJax-script" async src="../static/es5/tex-svg.js"></script>
</head>

<body>
	<div class="ui three item menu"><a class="header item" href="../index.html"><img src="../image/favicon.ico"> Comet OJ</a>
	</div>
	<div class="ui main container">
		<div class="ui center aligned grid">
			<div class="row">
				<h1 class="ui header">C0760 [HNOI2015]亚瑟王</h1>
			</div>
				<div class="row" style="margin-top: -15px"><span class="ui label">内存限制：256 MB</span> <span class="ui label">时间限制：1000 ms</span></div>
		</div>
		<div class="ui grid">
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">题目描述</h4>
					<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<p>小 K 不慎被 LL 邪教洗脑了，洗脑程度深到他甚至想要从亚瑟王邪教中脱坑。</p><p>他决定，在脱坑之前，最后再来打一盘亚瑟王。既然是最后一战，就一定要打得漂亮。众所周知，亚瑟王是一个看脸的游戏，技能的发动都是看概率的。作为一个非洲人，同时作为一个前 OIer，小 K 自然是希望最大化造成伤害的期望值。但他已经多年没写过代码，连 Spaly 都敲不对了，因此，希望你能帮帮小 K，让他感受一下当欧洲人是怎样的体验。</p><p>本题中我们将考虑游戏的一个简化版模型。</p><p>玩家有一套卡牌，共 $n$ 张。游戏时，玩家将 $n$ 张卡牌排列成某种顺序，排列后将卡牌按从前往后依次编号为 $1 \sim n$。本题中，顺序已经确定，即为输入的顺序。</p><p>每张卡牌都有一个技能。第 $i$ 张卡牌的技能发动概率为 $p_i$，如果成功发动，则会对敌方造成 $d_i$ 点伤害。也只有通过发动技能，卡牌才能对敌方造成伤害。基于现实因素以及小 K 非洲血统的考虑，$p_i$ 不会为 0，也不会为 1，即 $0 &lt; p_i &lt; 1$。</p><p>一局游戏一共有 $r$ 轮。在每一轮中，系统将从第一张卡牌开始，按照顺序依次考虑每张卡牌。在一轮中，对于依次考虑的每一张卡牌：</p><p>如果这张卡牌在这一局游戏中已经发动过技能，则</p><p>   1.如果这张卡牌不是最后一张，则跳过之（考虑下一张卡牌）；</p><p>   2.否则（是最后一张），结束这一轮游戏。</p><p>否则（这张卡牌在这一局游戏中没有发动过技能），设这张卡牌为第 $i$ 张。</p><p>   1.其将以 $p_i$ 的概率发动技能。</p><p>   2.如果技能发动，则对敌方造成 $d_i$ 点伤害，并结束这一轮。</p><p>   3.如果这张卡牌已经是最后一张（即 $i$ 等于 $n$），则结束这一轮；否则，考虑下一张卡牌。</p><p>请帮助小 K 求出这一套卡牌在一局游戏中能造成的伤害的期望值。</p>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输入格式</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>输入文件的第一行包含一个整数 $T$，代表测试数据组数。</p><p>接下来一共 $T$ 组数据。</p><p>每组数据的第一行包含两个用空格分开的整数 $n$ 和 $r$，分别代表卡牌的张数和游戏的轮数。</p><p>接下来 $n$ 行，每行包含一个实数和一个整数，由空格隔开，描述一张卡牌。第 $i$ 行的两个数为 $p_i$ 和 $d_i$，分别代表第 $i$ 张卡牌技能发动的概率（实数）和技能发动造成的伤害（整数）。保证 $p_i$ 最多包含四位小数，且为一个合法的概率。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输出</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>对于每组数据，输出一行，包含一个实数，为这套卡牌在这一局游戏中造成的伤害的期望值。</p><p>对于每一行输出，只有当你的输出和标准答案的相对误差不超过 $10^{-8}$ 时——即 $\frac{|a-o|}{a} \leq 10^{-8}$ 时 (其中 $a$ 是标准答案，$o$ 是输出)，你的输出才会被判为正确。建议输出十位小数。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">样例</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<h4>样例输入 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>1 
3 2 
0.5000 2 
0.3000 3 
0.9000 1</span></div></code></pre>
							</div>
							<h4>样例输出 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>3.2660250000</span></div></code></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">提示</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>样例解释</p><p>一共有 $13$ 种可能的情况：</p><p>1.第一轮中，第 $1$ 张卡牌发动技能；第二轮中，第 $2$ 张卡牌发动技能；概率为 $0.15$，伤害为 $5$。</p><p>2.第一轮中，第 $1$ 张卡牌发动技能；第二轮中，第 $3$ 张卡牌发动技能；概率为 $0.315$，伤害为 $3$。</p><p>3.第一轮中，第 $1$ 张卡牌发动技能；第二轮不发动技能；概率为 $0.035$，伤害为 $2$。</p><p>4.第一轮中，第 $2$ 张卡牌发动技能；第二轮中，第 $1$ 张卡牌发动技能；概率为 $0.075$，伤害为 $5$。</p><p>5.第一轮中，第 $2$ 张卡牌发动技能；第二轮中，第 $3$ 张卡牌发动技能；概率为 $0.0675$，伤害为 $4$。</p><p>6.第一轮中，第 $2$ 张卡牌发动技能；第二轮不发动技能； 概率为 $0.0075$，伤害为 $3$。</p><p>7.第一轮中，第 $3$ 张卡牌发动技能；第二轮中，第 $1$ 张卡牌发动技能；概率为 $0.1575$，伤害为 $3$。</p><p>8.第一轮中，第 $3$ 张卡牌发动技能；第二轮中，第 $2$ 张卡牌发动技能；概率为 $0.04725$，伤害为 $4$。</p><p>9.第一轮中，第 $3$ 张卡牌发动技能；第二轮不发动技能； 概率为 $0.11025$，伤害为 $1$。</p><p>10.第一轮不发动技能；第二轮中，第 $1$ 张卡牌发动技能； 概率为 $0.0175$，伤害为 $2$。</p><p>11.第一轮不发动技能；第二轮中，第 $2$ 张卡牌发动技能； 概率为 $0.00525$，伤害为 $3$。</p><p>12.第一轮不发动技能；第二轮中，第 $3$ 张卡牌发动技能； 概率为 $0.011025$，伤害为 $1$。</p><p>13.第一轮不发动技能；第二轮亦不发动技能； 概率为 $0.001225$，伤害为 $0$。</p><p>造成伤害的期望值为概率与对应伤害乘积之和，为 $3.266025$。</p><p>对于所有测试数据，$1 \leq T \leq 444, \ 1 \leq n \leq 220, \ 0 \leq r \leq 132, \ 0 &lt; p_i &lt; 1, \ 0 \leq d_i \leq 1000$。</p><p>除非备注中有特殊说明，数据中 $p_i$ 与 $d_i$ 均为随机生成。</p><p>请注意可能存在的实数精度问题，并采取适当措施。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>