<html>

<head>
	<meta charset="utf-8" />
	<link rel="icon" href="../image/favicon.ico" sizes="32x32" />
	<link rel="icon" href="../image/favicon.ico" sizes="192x192" />
	<link rel="stylesheet" type="text/css" href="../static/semantic.min.css">
	<script src="../static/jquery.min.js" type="text/javascript"></script>
	<script src="../static/semantic.min.js" type="text/javascript"></script>
	<title>[NOI2018Day2-B]情报中心</title>
	<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['$$$', '$$$']]
  },
  svg: {
    fontCache: 'global'
  }
};
	</script>
	<script type="text/javascript" id="MathJax-script" async src="../static/es5/tex-svg.js"></script>
</head>

<body>
	<div class="ui three item menu"><a class="header item" href="../index.html"><img src="../image/favicon.ico"> Comet OJ</a>
	</div>
	<div class="ui main container">
		<div class="ui center aligned grid">
			<div class="row">
				<h1 class="ui header">C0408 [NOI2018Day2-B]情报中心</h1>
			</div>
				<div class="row" style="margin-top: -15px"><span class="ui label">内存限制：512 MB</span> <span class="ui label">时间限制：8000 ms</span></div>
		</div>
		<div class="ui grid">
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">题目描述</h4>
					<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<p>C 国和 D 国近年来战火纷飞。</p><p>最近，C 国成功地渗透进入了 D 国的一个城市。这个城市可以抽象成一张有n个节点，节点之间由n-1条双向的边连接的无向图，使得任意两个点之间可以互相到达。也就是说，这张无向图实际上是一棵树。</p><p>经过侦查，C 国情报部部长 GGB 惊讶地发现，这座看起来不起眼的城市竟然是 D 国的军事中心。因此 GGB 决定在这个城市内设立情报机构。情报专家 TAC 在侦查后，安排了m种设立情报机构的方案。这些方案中，第$i$种方案是在节点$x_i$到节点$y_i$的最短路径的所有边上安排情报人员收集情报，这种方案需要花费$v_i$元的代价。</p><p>但是，由于人手不足，GGB 只能安排上述m种方案中的<b>两种</b>进行实施。同时 TAC 指出，为了让这两个情报机构可以更好的合作，它们收集情报的范围应<b>至少有一条公共的边</b>。为了评估一种方案的性能，GGB 和 TAC 对所有的边进行了勘察，给每一条边制定了一个情报价值$c_i$，表示收集这条边上的情报能够带来$c_i$元的收益。注意，情报是唯一的，因此当一条边的情报被两个情报机构收集时，也同样只会有$c_i$的收益。</p><p>现在，请你帮 GGB 选出两种合法的设立情报机构的方案进行实施，使得这两种方案收集情报的范围至少有一条公共的边，并且在此基础上<b>总收益减去总代价的差</b>最大。</p><p>注意，这个值可能是负的，但仍然是合法的。如果无法找到这样的两种方案，请输出<u>F</u>。</p>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输入格式</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>第一行包含一个整数$T$，表示数据组数；</p><p>每组数据包含（n+m+1）行：</p><p>第1行包含一个整数n，表示城市的点数；<br>第2到第n行中，第（i+1）行包含三个整数$a_i，b_i，c_i$，表示城市中一条连接节点$a_i$和$b_i$、情报价值为$c_i$的双向边，保证$a_i&lt;b_i$且$b_i$互不相同；<br>第（n+1）行包含一个整数m，表示 TAC 设立的m种设立情报机构的方案；<br>第（n+2）到（n+m+1）行中，第（n+i+1）行包含三个整数$x_i，y_i，v_i$，表示第$i$种设立情报机构的方案是在节点$x_i$到节点$y_i$的最短路径上的所有边上安排情报人员收集情报，并且需要花费$v_i$元的代价。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输出</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>包含$T$行；</p><p>对于每组数据，输出一行：如果存在合法的方案，则输出一个整数表示最大的总收益减去总代价的差；否则输出<b>F</b>。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">样例</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<h4>样例输入 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>2
5
1 2 1
2 3 3
3 4 2
1 5 8
2
1 4 5
3 5 8
5
1 2 1
2 3 3
3 4 3
1 5 9
2
1 5 5
2 3 8</span></div></code></pre>
							</div>
							<h4>样例输出 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>1
F</span></div></code></pre>
							</div>
							<h4>样例输入 2</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>1
11
1 2 2
1 3 0
2 4 1
3 5 7
1 6 0
1 7 1
1 8 1
6 9 3
4 10 2
4 11 8
10
7 10 2
10 7 0
2 11 1
8 6 7
7 7 0
10 1 1
8 2 1
7 8 3
7 7 3
3 9 9</span></div></code></pre>
							</div>
							<h4>样例输出 2</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>13</span></div></code></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">提示</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>【样例1解释】</p><p>这个样例中包含两组数据。这两组数据的城市相同，只是在情报的价值和情报机构的方案上有所不同。城市地图如下：<br></p><p><img alt="屏幕快照 2019-06-03 下午3.11.51.png" src="../upload/510d64fccb.png" width="500" height="46.8384074941452"><br></p><ul><li>对于第一组数据，方案一中的节点1到节点4的最短路径为$1 \to 2 \to 3 \to 4$，方案二中的节点3到节点5的最短路径为$3 \to 2 \to 1 \to 5$。选择这两种方案需要花费5+8=13的代价，并且每一条边的情报都被收集从而得到1+3+2+8=14的收益，因此总收益减去总代价为14-13=1。</li><li>对于第二组数据，方案一中的节点1到节点5的最短路径为$1\to5$，方案二中的节点2到节点3的最短路径为$2 \to 3$。这两种方案收集情报的范围没有公共的 边，因此非法，所以这组数据不存在合法方案，应输出F。</li></ul><p>【样例2解释】<br></p><p>这一数据中，最优方案为选择第2种和第3种方案。<br></p><p>这组数据的城市地图如下，其中<b>加粗</b>的边表示被情报中心收集情报的边，<font>红色</font>的边表示只被第2种方案的情报中心收集情报的边，<font>蓝色</font>的边表示只被第3种方案的情报中心收集情报的边，<font>紫色</font>的边表示同时被两个情报中心收集情报的边。<br></p><p><img alt="屏幕快照 2019-06-03 下午3.24.10.png" src="../upload/fea4f124c3.png" width="500" height="341.3001912045889"><br></p><p>【子任务】</p><p><img alt="屏幕快照 2019-06-03 下午3.25.28.png" src="../upload/295b3728eb.png" width="400" height="653.6"><br></p><p>表格中的特殊性质如下：</p><ul><li><p>特殊性质$S_1$：对于任意$i,j$，保证$x_i$到$y_i$的最短路径所经过的编号最小的节点不同于$x_j$到$y_j$的最短路径所经过的编号最小的节点；</p></li><li><p>特殊性质$S_2$：对于任意$i$，保证$x_i$到$y_i$的最短路径所经过的编号最小的节点为节点1。</p></li></ul><p>对于所有的数据，$1\le n \le 5 \times 10^4，0 \le m \le 10^5，0 \le c_i \le 10^9，0 \le v_i \le 10^{10} \times n$。每个测试点中，所有n的和不会超过1000233，所有m的和不会超过2000233。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>