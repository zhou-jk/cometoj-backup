<html>

<head>
	<meta charset="utf-8" />
	<link rel="icon" href="../image/favicon.ico" sizes="32x32" />
	<link rel="icon" href="../image/favicon.ico" sizes="192x192" />
	<link rel="stylesheet" type="text/css" href="../static/semantic.min.css">
	<script src="../static/jquery.min.js" type="text/javascript"></script>
	<script src="../static/semantic.min.js" type="text/javascript"></script>
	<title>[NOI2009Day2-B]管道取珠</title>
	<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['$$$', '$$$']]
  },
  svg: {
    fontCache: 'global'
  }
};
	</script>
	<script type="text/javascript" id="MathJax-script" async src="../static/es5/tex-svg.js"></script>
</head>

<body>
	<div class="ui three item menu"><a class="header item" href="../index.html"><img src="../image/favicon.ico"> Comet OJ</a>
	</div>
	<div class="ui main container">
		<div class="ui center aligned grid">
			<div class="row">
				<h1 class="ui header">C0368 [NOI2009Day2-B]管道取珠</h1>
			</div>
				<div class="row" style="margin-top: -15px"><span class="ui label">内存限制：256 MB</span> <span class="ui label">时间限制：2000 ms</span></div>
		</div>
		<div class="ui grid">
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">题目描述</h4>
					<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<p>管道取珠是小X很喜欢的一款游戏。在本题中，我们将考虑该游戏的一个简单改版。游戏画面如图1所示：<br></p><p><img alt="屏幕快照 2019-06-06 下午6.53.16.png" src="../upload/ebbc184218.png" width="500" height="141.21510673234812"><br></p><p>游戏初始时，左侧上下两个管道分别有一定数量的小球（有深色球和浅色球两种类型），而右侧输出管道为空。每一次操作，可以从左侧选择一个管道，并将该管道中<b>最右侧的球</b>推入右边输出管道。</p><p>例如，我们首先从下管道中移一个球到输出管道中，将得到图2所示的情况。</p><p><img alt="屏幕快照 2019-06-06 下午6.53.24.png" src="../upload/23733fdd2c.png" width="500" height="138.29787234042553"><br></p><p>假设上管道中有n个球,下管道中有m个球，则整个游戏过程需要进行n+m次操作，即将所有左侧管道中的球移入输出管道。最终n+m个球在输出管道中从右到左形成输出序列。</p><p>爱好数学的小X知道，他共有C(n+m,n)种不同的操作方式，而不同的操作方式可能导致相同的输出序列。举个例子，对于图3所示的游戏情形：</p><p><img alt="屏幕快照 2019-06-06 下午6.53.34.png" src="../upload/8f72ec71ad.png" width="500" height="140.625"><br></p><p>我们用A表示浅色球，B表示深色球。并设移动上管道右侧球的操作为U，移动下管道右侧球的操作为D，则共有C(2+1,1)=3种不同的操作方式，分别为UUD,UDU, DUU；最终在输出管道中形成的<b>输出序列(从右到左)</b>分别为BAB，BBA，BBA。可以发现后两种操作方式将得到同样的<b>输出序列</b>。</p><p>假设最终可能产生的不同种类的<b>输出序列</b>共有K种，其中第$i$种输出序列的产生方式（即不同的操作方式数目）有$a_i$个。聪明的小X早已知道，$\sum_{i=1}^{k}a_i=C(n+m,n)$</p><p>因此，小X希望计算得到$\sum_{i=1}^{k}a_i^2$</p><p>你能帮助他计算这个值么?由于这个值可能很大，因此只需要输出该值对1024523的取模即可（即除以1024523的余数）。</p><p>说明：文中C(n+m,n)表示组合数。组合数C(a,b)等价于在a个不同的物品中选取b个的选取方案数。</p>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输入格式</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>第一行包含两个整数n,m，分别表示上下两个管道中球的数目。</p><p>第二行为一个AB字符串，长度为n，表示上管道中<b>从左到右</b>球的类型。其中A表示浅色球，B表示深色球。</p><p>第三行为一个AB字符串，长度为m，表示下管道中的情形。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输出</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>仅包含一行，即为$\sum_{i=1}^{k}a_i^2$除以1024523的余数。<br></p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">样例</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<h4>样例输入 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>2 1
AB
B</span></div></code></pre>
							</div>
							<h4>样例输出 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>5</span></div></code></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">提示</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>【样例说明】<br></p><p>样例即为文中(图3)。共有两种不同的<b>输出序列</b>形式，序列BAB有1种产生方式，而序列BBA有2种产生方式，因此答案为5。<br></p><p>【大致数据规模】<br></p><p>约30%的数据满足$n,m≤ 12$;<br>约100%的数据满足$n,m≤ 500$。<br></p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>