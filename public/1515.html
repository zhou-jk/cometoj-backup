<html>

<head>
	<meta charset="utf-8" />
	<link rel="icon" href="../image/favicon.ico" sizes="32x32" />
	<link rel="icon" href="../image/favicon.ico" sizes="192x192" />
	<link rel="stylesheet" type="text/css" href="../static/semantic.min.css">
	<script src="../static/jquery.min.js" type="text/javascript"></script>
	<script src="../static/semantic.min.js" type="text/javascript"></script>
	<title>[Ynoi]2012-F</title>
	<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['$$$', '$$$']]
  },
  svg: {
    fontCache: 'global'
  }
};
	</script>
	<script type="text/javascript" id="MathJax-script" async src="../static/es5/tex-svg.js"></script>
</head>

<body>
	<div class="ui three item menu"><a class="header item" href="../index.html"><img src="../image/favicon.ico"> Comet OJ</a>
	</div>
	<div class="ui main container">
		<div class="ui center aligned grid">
			<div class="row">
				<h1 class="ui header">C1515 [Ynoi]2012-F</h1>
			</div>
				<div class="row" style="margin-top: -15px"><span class="ui label">内存限制：256 MB</span> <span class="ui label">时间限制：1000 ms</span></div>
		</div>
		<div class="ui grid">
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">题目描述</h4>
					<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<p>$n$ 个结点的有根树，每个结点有一种颜色</p><p>定义一个点所在的块为仅保留两端结点颜色相同的边时，这个点所在的连通分量</p><p>定义一个块的深度是 $\max(dep[a]-dep[b]+1)$，s.t.：$a,b$ 是块中的结点， $dep[根]=0，dep[w]=dep[w 的父亲]+1$</p><p>操作 $1$：给出 $x$ 和 $y$，把结点 $x$ 的颜色改成 $y$</p><p>操作 $2$：给出 $x$ 和 $y$，把结点 $x$ 所在的块中所有点颜色改为 $y$</p><p>操作 $3$：给出 $x$，问结点 $x$ 的颜色，$x$ 所在块的点数，$x$ 所在块的深度</p>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输入格式</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>第一行一个数 $n$ 。</p><p>第二行 $n$ 个数表示每个节点的父亲，其中第 $i$ 个数$&lt;i$，且 $1$ 节点的父亲输入为 $0$ 。</p><p>第三行 $n$ 个数表示每个节点的颜色。</p><p>第四行一个数 $m$。</p><p>之后 $m$ 行，每行一个操作：<code>1 x y</code>、<code>2 x y</code>、<code>3 x</code>依次代表前面提及的一种操作。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输出</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>对于每个 $3$ 操作，输出一行三个数，中间用空格隔开，依次表示：结点 $x$ 的颜色， $x$ 所在块的点数，$x$ 所在块的深度。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">样例</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<h4>样例输入 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>10
0 1 1 1 3 4 2 4 2 3
16 20 29 16 23 6 29 21 1 22
10
3 4
3 4
2 6 20
2 1 8
2 2 8
1 9 21
3 6
3 2
1 3 11
1 4 17</span></div></code></pre>
							</div>
							<h4>样例输出 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>16 2 2
16 2 2
20 1 1
8 3 2</span></div></code></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">提示</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>$n , m \le 100000$，颜色至多 $30$ 种，在 $[1,30]$ 内。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>