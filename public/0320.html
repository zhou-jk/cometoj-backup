<html>

<head>
	<meta charset="utf-8" />
	<link rel="icon" href="../image/favicon.ico" sizes="32x32" />
	<link rel="icon" href="../image/favicon.ico" sizes="192x192" />
	<link rel="stylesheet" type="text/css" href="../static/semantic.min.css">
	<script src="../static/jquery.min.js" type="text/javascript"></script>
	<script src="../static/semantic.min.js" type="text/javascript"></script>
	<title>[NOI2006Day2-C]神奇口袋</title>
	<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\(', '\)']]
  },
  svg: {
    fontCache: 'global'
  }
};
	</script>
	<script type="text/javascript" id="MathJax-script" async src="../static/es5/tex-svg.js"></script>
</head>

<body>
	<div class="ui three item menu"><a class="header item" href="../index.html"><img src="../image/favicon.ico"> Comet OJ</a>
	</div>
	<div class="ui main container">
		<div class="ui center aligned grid">
			<div class="row">
				<h1 class="ui header">C0320 [NOI2006Day2-C]神奇口袋</h1>
			</div>
				<div class="row" style="margin-top: -15px"><span class="ui label">内存限制：256 MB</span> <span class="ui label">时间限制：1000 ms</span></div>
		</div>
		<div class="ui grid">
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">题目描述</h4>
					<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<p>Pòlya获得了一个奇妙的口袋，上面写着人类难以理解的符号。Pòlya看得入了迷，冥思苦想，发现了一个神奇的模型（被后人称为Pòlya模型）。为了生动地讲授这个神奇的模型，他带着学生们做了一个虚拟游戏：<br></p><p>游戏开始时，袋中装入$a_1$个颜色为1的球，$a_2$个颜色为2的球，...，$a_t$个颜色为t的球，其中$a_i \in Z^+(1≤i≤t)$。</p><p>游戏开始后，每次严格进行如下的操作：<br></p><p>从袋中随机的抽出一个小球（袋中所有小球被抽中的概率相等），Pòlya独自观察这个小球的颜色后将其<b>放回</b>，<b>然后再把</b>$d$个与其颜色相同的小球放到口袋中。</p><p>设$c_i$表示第$i$次抽出的小球的颜色($1≤c_i≤t$)，一个游戏过程将会产生一个颜色序列($c_1,c_2,...,c_n,...$)。</p><p>Pòlya把游戏开始时$t$种颜色的小球每一种的个数$a_1,a_2,...,a_t$告诉了所有学生。然后他问学生：一次游戏过程产生的颜色序列满足下列条件的概率有多大？<br></p><p>$c_{x_1}=y_1,c_{x_2}=y_2,...,c_{x_i}=y_i,...,c_{x_n}=y_n$<br></p><p>其中$0&lt;x_1&lt;x_2&lt;...&lt;x_n，1≤y_i≤t$。换句话说，已知($t,n,d,a_1,a_2,...,a_t,x_1,y_1,x_2,y_2,...,x_n,y_n$)，你要回答有多大的可能性会发生下面的事件：“对所有$k,1≤k≤n$，第$x_k$次抽出的球的颜色为$y_k$”。<br></p>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输入格式</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>第一行有三个正整数$t，n，d$；</p><p>第二行有$t$个正整数$a_1,a_2,...,a_t$，表示游戏开始时口袋里$t$种颜色的球，每种球的个数。</p><p>以下$n$行，每行有两个正整数$x_i,y_i$，表示第$x_i$次抽出颜色为的$y_i$球。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输出</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>要求用分数形式输出（显然此概率为有理数）。输出包含一行，格式为：分子/分母。同时要求输出最简形式（分子分母互质）。特别的，概率为0应输出0/1，概率为1应输出1/1。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">样例</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<h4>样例输入 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>2 3 1
1 1
1 1
2 2
3 1</span></div></code></pre>
							</div>
							<h4>样例输出 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>1/12</span></div></code></pre>
							</div>
							<h4>样例输入 2</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>3 1 2
1 1 1
5 1</span></div></code></pre>
							</div>
							<h4>样例输出 2</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>1/3</span></div></code></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">提示</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>【样例1说明】<br></p><p>初始时，两种颜色球数分别为(1, 1)，取出色号为1的球的概率为1/2;第二次取球之前，两种颜色球数分别为(2, 1)，取出色号为2的球的概率为1/3;第三次取球之前，两种颜色球数分别为(2, 2)，取出色号为1的球的概率为1/2，所以三次取球的总概率为1/12。<br></p><p>【数据规模和约定】<br></p><p>$1≤t,n≤1000, 1≤a_k,d≤10, 1≤x_1&lt;x_2&lt;...&lt;x_n≤10000, 1≤y_k≤t$</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>