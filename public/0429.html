<html>

<head>
	<meta charset="utf-8" />
	<link rel="icon" href="../image/favicon.ico" sizes="32x32" />
	<link rel="icon" href="../image/favicon.ico" sizes="192x192" />
	<link rel="stylesheet" type="text/css" href="../static/semantic.min.css">
	<script src="../static/jquery.min.js" type="text/javascript"></script>
	<script src="../static/semantic.min.js" type="text/javascript"></script>
	<title>[WC2019-A]数树</title>
	<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['$$$', '$$$']]
  },
  svg: {
    fontCache: 'global'
  }
};
	</script>
	<script type="text/javascript" id="MathJax-script" async src="../static/es5/tex-svg.js"></script>
</head>

<body>
	<div class="ui three item menu"><a class="header item" href="../index.html"><img src="../image/favicon.ico"> Comet OJ</a>
	</div>
	<div class="ui main container">
		<div class="ui center aligned grid">
			<div class="row">
				<h1 class="ui header">C0429 [WC2019-A]数树</h1>
			</div>
				<div class="row" style="margin-top: -15px"><span class="ui label">内存限制：512 MB</span> <span class="ui label">时间限制：4000 ms</span></div>
		</div>
		<div class="ui grid">
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">题目描述</h4>
					<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<p>白兔喜欢树。</p><p>白云喜欢数数。</p><p>有 $n$ 只鼠，白兔用 $n−1$ 根蓝色绳子把它们连成了一棵树，每根蓝色绳子连着两只鼠，白云用 $n−1$ 根红色绳子把它们连成了一棵树，每根红色绳子连接着两只鼠。</p><p>白云要给予每只鼠一个数。这个数可以是 $[1,y]$ 中的任意一个整数。</p><p>白兔给了白云一个要求：对于两只鼠 $p,q$，若存在一条连接这两只鼠的路径同时属于这两棵树，则 $p$ 和 $q$ 必须被给予相同的整数。存在一条路径同时属于这两棵树指的是：存在一个序列 $(a_1=p,a_2,⋯,a_m=q)$，使得：对于所有 $i \in [1,m−1]$，都有 $a_i$ ​和 $a_{i+1}$ 既有一根红色绳子直接相连也有一根蓝色绳子直接相连。</p><p>白云想知道，她有多少种给予数的方案呢？</p><p>鼠在不停地挣扎，想要摆脱绳子的束缚。白云还没有思考出来，鼠便把红色绳子都咬断了。</p><p>白兔有些气恼，但是他还是想要知道答案。他便问白云：对于所有红色绳子的连接方案，答案的总和（即求所有红色绳子连接方案的给予数方案之和）是多少？</p><p>鼠在不停地挣扎，想要摆脱绳子的束缚。白云还没有思考出来，鼠便把蓝色绳子也咬断了。</p><p>白兔有些气恼，但是他还是想要知道答案。他便问白云：对于所有红色和蓝色绳子的连接方案，答案的总和（即求所有红色和蓝色绳子连接方案的给予数方案之和）是多少？两个方案不同当且仅当存在至少一对鼠，在两种方案中，这两只鼠之间直接连接的绳子不同（两只鼠之间连接绳子的可能性有 4 种：没有绳子直接连接，只有红色绳子直接连接，只有蓝色绳子直接连接，两种颜色的绳子均直接连接）。</p><p>白云哭了。</p><p>本题包含三个问题：</p><ul><li>问题 0：已知两棵 $n$ 个节点的树的形态（两棵树的节点标号均为 $1$ 至 $n$），其中第一棵树是红树，第二棵树是蓝树。要给予每个节点一个 $[1,y]$ 中的整数，使得对于任意两个节点 $p,q$，如果存在一条路径 $(a_1=p,a_2,⋯,a_m=q)$ 同时属于这两棵树，则 $p,q$ 必须被给予相同的数。求给予数的方案数。</li><li>问题 1：已知蓝树，对于红树的所有 $n^{n−2}$ 种选择方案，求问题 0 的答案之和。</li><li>问题 2：对于蓝树的所有 $n^{n−2}$ 种选择方案，求问题 1 的答案之和。</li></ul><p>提示：$n$ 个节点的树一共有 $n^{n−2}$ 种。</p><p>在不同的测试点中，你将可能需要回答不同的问题。我们将用 $op$ 来指代你需要回答的问题编号（对应上述 0、 1、 2）。</p><p>由于答案可能很大，因此你只需要输出答案对 $998,244,353$ 取模的结果即可。</p>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输入格式</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>第一行三个用空格隔开的整数 $n,y,op$。 如果 $op=0$，则接下来 $2×(n−1)$ 行，前 $(n−1)$ 行每描述一条蓝色绳子，接下来 $(n−1)$ 行每行描述一条红色绳子。</p><p>如果 $op=1$，则接下来 $(n−1)$ 行，每行描述一条蓝色绳子。</p><p>如果 $op=2$，则接下来没有输入。</p><p>描述绳子的各行将包含两个用空格隔开的整数，分别表示被这条绳子连接的两只鼠的编号。鼠的编号是从 $1$ 开始的。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输出</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>输出一个整数，表示答案对 $998,244,353$ 取模的结果。<br></p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">样例</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<h4>样例输入 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>3 2 0
1 2
2 3
1 2
2 3</span></div></code></pre>
							</div>
							<h4>样例输出 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>2</span></div></code></pre>
							</div>
							<h4>样例输入 2</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>3 2 1
1 2
2 3</span></div></code></pre>
							</div>
							<h4>样例输出 2</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>2</span></div></code></pre>
							</div>
							<h4>样例输入 3</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>3 2 2</span></div></code></pre>
							</div>
							<h4>样例输出 3</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>30</span></div></code></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">提示</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>【样例1说明】</p><p>两棵树相同，所以任意两个点都必须被给予相同的数，方案数为 $2$。</p><p>【样例2说明】<br></p><p>红树共有三种可能的情况：</p><ul><li>包含绳子 $(1,2)$（表示连接$1,2$号鼠的绳子，下同）、$(2,3)$：此时任意两只鼠都必须被给予相同的数，问题 0 的答案为 $2$。</li><li>包含绳子 $(1,2)$、$(1,3)$：此时1号鼠和2号鼠必须被给予相同的数，问题 0 的答案为 $2×2=4$。</li><li>包含绳子 $(2,3)$、$(1,3)$：此时2号点和3号点必须被给予相同的数，问题 0 的答案为 $2×2=4$。</li></ul><p>综上，问题 1 的答案为 $2+4+4=10$。</p><p>【样例3说明】</p><p>蓝树一共有三种可能的情况。不难发现，对于蓝树的每一种情况，求得的问题 1 的答案都是 $10$。所以答案为 $10×3=30$。<br></p><p>【数据规模】</p><p><img alt="屏幕快照 2019-06-25 下午5.32.40.png" src="../upload/465e873d1f.png" width="600" height="618.8571428571429"><br></p><p>所有测试点均满足 $3 \times 10^5, 1 \le y \le 998244353, op \in \{0, 1, 2\}$</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>