<html>

<head>
	<meta charset="utf-8" />
	<link rel="icon" href="../image/favicon.ico" sizes="32x32" />
	<link rel="icon" href="../image/favicon.ico" sizes="192x192" />
	<link rel="stylesheet" type="text/css" href="../static/semantic.min.css">
	<script src="../static/jquery.min.js" type="text/javascript"></script>
	<script src="../static/semantic.min.js" type="text/javascript"></script>
	<title>[BJOI2011]梦想封印</title>
	<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\(', '\)']]
  },
  svg: {
    fontCache: 'global'
  }
};
	</script>
	<script type="text/javascript" id="MathJax-script" async src="../static/es5/tex-svg.js"></script>
</head>

<body>
	<div class="ui three item menu"><a class="header item" href="../index.html"><img src="../image/favicon.ico"> Comet OJ</a>
	</div>
	<div class="ui main container">
		<div class="ui center aligned grid">
			<div class="row">
				<h1 class="ui header">C0666 [BJOI2011]梦想封印</h1>
			</div>
				<div class="row" style="margin-top: -15px"><span class="ui label">内存限制：256 MB</span> <span class="ui label">时间限制：1000 ms</span></div>
		</div>
		<div class="ui grid">
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">题目描述</h4>
					<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<p>渐渐地，Magic&nbsp;Land 上的人们对那座岛屿上的各种现象有了深入的了解。</p><p>为了分析一种奇特的称为梦想封印（Fantasy&nbsp;Seal）的特技，需要引入如下的概念：</p><p>每一位魔法的使用者都有一个“魔法脉络”，它决定了可以使用的魔法的种类。</p><p>一般地，一个“魔法脉络”可以看作一个无向图，有 $N$ 个结点及 $M$ 条边，将结点编号为 $1$ ~ $N$，其中有一个结点是特殊的，称为核心（Kernel），记作 $<font>1$</font><font>号结点</font>。每一条边有一个固有（即生成之后再也不会发生变化的）权值，是一个不超过 $U$ 的自然数。</p><p>每一次魔法驱动，可看作是由核心（Kernel）出发的一条有限长的道路（Walk），可以经过一条边多次，所驱动的魔法类型由以下方式给出：</p><p>将经过的每一条边的权值异或（xor）起来，得到 $s$。</p><p>如果 $s$ 是 $0$，则驱动失败，否则将驱动编号为 $s$ 的魔法（每一个正整数编号对应了唯一一个魔法）。</p><p>需要注意的是，如果经过了一条边多次，则每一次都要计入 $<font>s$</font><font>中。</font></p><p>这样，魔法脉络决定了可使用魔法的类型，当然，由于魔法与其编号之间的关系尚未得到很好的认知，此时人们仅仅关注可使用魔法的种类数。</p><p>梦想封印可以看作是对“魔法脉络”的破坏：</p><p>该特技作用的结果是，“魔法脉络”中的一些边逐次地消失。</p><p>我们记总共消失了 $Q$ 条边，按顺序依次为 $Dis_1$、$<font>Dis_</font>2$、……、$<font>Dis_</font>Q$。</p><p>给定了以上信息，你要计算的是梦想封印作用过程中的效果，这可以用 $Q+1$ 个自然数来描述：</p><p>$Ans_0$ 为初始时可以使用魔法的数量。</p><p>$Ans_1$ 为 $Dis_1$ 被破坏（即边被删去）后可以使用魔法的数量。</p><p>$Ans_2$ 为 $Dis_1$ 及 $Dis_2$ 均被破坏后可使用魔法的数量。</p><p>……</p><p>$Ans_Q$ 为 $Dis_1$、$Dis_2$、……、$Dis_Q$ 全部被破坏后可以使用魔法的数量。</p>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输入格式</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>第一行包含三个正整数 $N$、$<font>M$</font><font>、$</font><font>Q$</font>。</p><p>接下来的 $M$ 行，每行包含 $3$ 个整数，$A_i$、$B_i$、$W_i$，表示一条权为 $W_i$ 的与结点 $A_i$、$B_i$ 关联的无向边，其中 $W_i$ 是不超过 $U$ 的自然数。</p><p>接下来 $Q$ 行，每行一个整数：$Dis_i$。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输出</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>一共包 $Q+1$ 行，依次为 $Ans_0$、$<font>Ans_</font>1$、……、$<font>Ans_</font>Q$。<br></p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">样例</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<h4>样例输入 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>3 3 2
1 2 1
2 3 2
3 1 4
1
3</span></div></code></pre>
							</div>
							<h4>样例输出 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>5
2
0</span></div></code></pre>
							</div>
							<h4>样例输入 2</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>5 7 7
1 2 1
1 3 1
2 4 2
2 5 2
4 5 4
5 3 9
4 3 1
7
6
5
4
3
2
1</span></div></code></pre>
							</div>
							<h4>样例输出 2</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>15
11
5
2
2
1
1
0</span></div></code></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">提示</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>【样例 1 解释】</p><p>初始时可使用编号为 1、3、4、6、7 的魔法。</p><p>在删去第 1 条边（连结 1、2 结点的边）后，可使用 4 和 6 号魔法。</p><p>第 3 条边（连结第 1、3 结点的边）也被删去后，核心（Kernel）即结点 1 孤立，易知此时无法使用魔法。</p><p>【数据规模和约定】<br><br>所有数据保证该无向图不含重边、自环。</p><p>所有数据保证不会有一条边被删除多次，即对于不同 $i$ 和 $j$，有 $Dis_i≠Dis_j$</p><p>30% 的数据中 $N ≤ 50，M ≤ 50，Q ≤50，U≤100$；</p><p>60% 的数据中 $N ≤ 300，M ≤ 300，Q ≤50，U≤10^9$；</p><p>80% 的数据中 $N ≤ 300，M ≤ 5000，Q ≤5000，U≤10^{18}$；</p><p>100% 的数据中 $N ≤ 5000，M ≤ 20000，Q ≤20000，U≤10^{18}$；</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>