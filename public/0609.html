<html>

<head>
	<meta charset="utf-8" />
	<link rel="icon" href="../image/favicon.ico" sizes="32x32" />
	<link rel="icon" href="../image/favicon.ico" sizes="192x192" />
	<link rel="stylesheet" type="text/css" href="../static/semantic.min.css">
	<script src="../static/jquery.min.js" type="text/javascript"></script>
	<script src="../static/semantic.min.js" type="text/javascript"></script>
	<title>[SDOI2017]相关分析</title>
	<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\(', '\)']]
  },
  svg: {
    fontCache: 'global'
  }
};
	</script>
	<script type="text/javascript" id="MathJax-script" async src="../static/es5/tex-svg.js"></script>
</head>

<body>
	<div class="ui three item menu"><a class="header item" href="../index.html"><img src="../image/favicon.ico"> Comet OJ</a>
	</div>
	<div class="ui main container">
		<div class="ui center aligned grid">
			<div class="row">
				<h1 class="ui header">C0609 [SDOI2017]相关分析</h1>
			</div>
				<div class="row" style="margin-top: -15px"><span class="ui label">内存限制：256 MB</span> <span class="ui label">时间限制：1000 ms</span></div>
		</div>
		<div class="ui grid">
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">题目描述</h4>
					<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<p>Frank 对天文学非常感兴趣，他经常用望远镜看星星， 同时记录下它们的信息，比如亮度、颜色等等，进而估算出星星的距离、半径等等。</p><p>Frank 不仅喜欢观测，还喜欢分析观测到的数据。他经常分析两个参数之间 （比如亮度和半径） 是否存在某种关系。</p><p>现在 Frank 要分析参数 $X$ 与 $Y$ 之间的关系。他有 $n$ 组观测数据，第 $i$ 组观测数据记录了 $x_i$ 和 $y_i$。他需耍进行以下几种操作：</p><p>*$\texttt{1 L R}$</p><p>用直线拟合第 $ L $ 组到第 $ R $ 组观测数据。用 $ \bar x $ 表示这些观测数据中 $ x $ 的平均数，用 $ \bar y $ 表示这些观测数据中 $ y $ 的平均数，即</p><p>$\bar{x} = \frac{1}{R - L + 1} \sum\limits_{i = L} ^ R x_i$</p><p>$\bar{y} = \frac{1}{R - L + 1} \sum\limits_{i = L} ^ R y_i$</p><p>如果直线方程是 $ y = ax + b $，那么 $ a $、$ b $ 应该这样计算：</p><p>$a = \frac{\sum\limits_{i = L} ^ R (x_i - \bar{x})(y_i - \bar{y})}{\sum\limits_{i = L} ^ R (x_i - \bar{x}) ^ 2} $</p><p>$b = \bar{y} - a \bar{x}$</p><p>你需要帮助 Frank 计算 $ a $。</p><p>*$\texttt{2 L R S T}$</p><p>Frank 发现测量第 $ L $ 组到第 $ R $ 组数据时有误差，对于每个 $ i $ 满足 $ L \leq i \leq R $，$ x_i $ 需要加上 $ S $，$ y_i $ 需要加上 $ T $。</p><p>*$\texttt{3 L R S T}$</p><p>Frank 发现第 $ L $ 组到第 $ R $ 组数据需要修改，对于每个 $ i $ 满足 $ L \leq i \leq R $，$ x_i $ 需要修改为 $ (S + i) $，$ y_i $ 需要修改为 $ (T + i) $。</p>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输入格式</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>第一行两个数 $n$、$m$，表示观测数据组数和操作次数。</p><p>接下来一行 $n$ 个数，第 $i$ 个数是 $x_i$。</p><p>接下来一行 $n$ 个数，第 $i$ 个数是 $y_i$。</p><p>接下来 $m$ 行，表示操作，格式见题目描述。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输出</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>对于每个 $1$ 操作，输出一行，表示直线斜率 $a$。选手输出与标准输出的绝对误差或相对误差不超过 $10 ^ {-5}$ 即为正确。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">样例</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<h4>样例输入 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>3 5
1 2 3
1 2 3
1 1 3
2 2 3 -3 2
1 1 2
3 1 2 2 1
1 1 3</span></div></code></pre>
							</div>
							<h4>样例输出 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>1.0000000000
-1.5000000000
-0.6153846154</span></div></code></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">提示</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>对于 $20\%$ 的数据，$1 \leq n, m \leq 1000$；</p><p>对于另外 $20\%$ 的数据没有 $3$ 操作，且 $2$ 操作中 $S = 0$；</p><p>对于另外 $30\%$ 的数据没有 $3$ 操作；</p><p>对于 $100\%$的数据，$1 \leq n, m \leq 10 ^ 5$；</p><p>对于所有数据，$1 \leq L \leq R \leq n, 0 \leq |S|, |T | \leq 10 ^ 5, 0 \leq |x_i|, |y_i| \leq 10 ^ 5$；</p><p>对于所有数据，$1$ 操作中不会出现分母为 $0$ 这类特殊情况。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>