<html>

<head>
	<meta charset="utf-8" />
	<link rel="icon" href="../image/favicon.ico" sizes="32x32" />
	<link rel="icon" href="../image/favicon.ico" sizes="192x192" />
	<link rel="stylesheet" type="text/css" href="../static/semantic.min.css">
	<script src="../static/jquery.min.js" type="text/javascript"></script>
	<script src="../static/semantic.min.js" type="text/javascript"></script>
	<title>[NOI2006Day1-A]网络收费</title>
	<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\(', '\)']]
  },
  svg: {
    fontCache: 'global'
  }
};
	</script>
	<script type="text/javascript" id="MathJax-script" async src="../static/es5/tex-svg.js"></script>
</head>

<body>
	<div class="ui three item menu"><a class="header item" href="../index.html"><img src="../image/favicon.ico"> Comet OJ</a>
	</div>
	<div class="ui main container">
		<div class="ui center aligned grid">
			<div class="row">
				<h1 class="ui header">C0323 [NOI2006Day1-A]网络收费</h1>
			</div>
				<div class="row" style="margin-top: -15px"><span class="ui label">内存限制：256 MB</span> <span class="ui label">时间限制：3000 ms</span></div>
		</div>
		<div class="ui grid">
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">题目描述</h4>
					<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<p>网络已经成为当今世界不可或缺的一部分。每天都有数以亿计的人使用网络进行学习、科研、娱乐等活动。然而，不可忽视的一点就是网络本身有着庞大的运行费用。所以，向使用网络的人进行适当的收费是必须的，也是合理的。<br></p><p>MY市NS中学就有着这样一个教育网络。网络中的用户一共有$2^N$个，编号依次为$1, 2, 3, ..., 2^N$。这些用户之间是用路由点和网线组成的。用户、路由点与网线共同构成一个满二叉树结构。树中的每一个叶子结点都是一个用户，每一个非叶子结点（灰色）都是一个路由点，而每一条边都是一条网线（见下图，用户结点中的数字为其编号）。<br></p><p><img alt="屏幕快照 2019-06-10 下午4.32.40.png" src="../upload/e426a336bf.png" width="400" height="226.02739726027397"><br></p><p>MY网络公司的网络收费方式比较奇特，称为“ 配对收费 ”。即对于每两个用户$i,j(1≤i&lt;j≤2^N)$进行收费。由于用户可以自行选择两种付费方式A、B中的一种，所以网络公司向学校收取的费用与每一位用户的付费方式有关。该费用等于每两位不同用户配对产生费用之和。<br></p><p>为了描述方便，首先定义这棵网络树上的一些概念：<br></p><ul><li>祖先：根结点没有祖先，非根结点的祖先包括它的父亲以及它的父亲的祖先;</li><li>管辖叶结点：叶结点本身不管辖任何叶结点，非叶结点管辖它的左儿子所管辖的叶结点与它的右儿子所管辖的叶结点;</li><li>距离：在树上连接两个点之间的用边最少的路径所含的边数。<br></li></ul><p>对于任两个用户$i,j(1≤i&lt;j≤2^N)$，首先在树上找到与它们距离最近的公共祖先：路由点P，然后观察P所管辖的叶结点（即用户）中选择付费方式A与B的人数，分别记为nA与nB，接着按照网络管理条例第X章第Y条第Z款进行收费（如下表），其中$Fi,j$为$i$和$j$之间的流量，且为已知量。<br></p><p><img alt="屏幕快照 2019-06-10 下午4.40.28.png" src="../upload/181f865cdf.png" width="600" height="229.4853963838665"><br></p><p>由于最终所付费用与付费方式有关，所以NS中学的用户希望能够自行改变自己的付费方式以减少总付费。然而，由于网络公司已经将每个用户注册时所选择的付费方式记录在案，所以对于用户$i$，如果他/她想改变付费方式（由A改为B或由B改为A），就必须支付$C_i$元给网络公司以修改档案（修改付费方式记录）。</p><p>现在的问题是，给定每个用户注册时所选择的付费方式以及$C_i$，试求这些用户应该如何选择自己的付费方式以使得NS中学支付给网络公司的总费用最少（更改付费方式费用+配对收费的费用）。</p>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输入格式</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>第一行有一个正整数$N$。<br></p><p>第二行有$2^N$个整数，依次表示1号，2号，...，$2^N$号用户注册时的付费方式，每一个数字若为0，则表示对应用户的初始付费方式为A，否则该数字为1，表示付费方式为B。</p><p>第三行有$2^N$个整数，表示每一个用户修改付费方式需要支付的费用，依次为$C_1,C_2, ...,C_M$。($ M=2^N$)</p><p>以下$2^N-1$行描述给定的两两用户之间的流量表F，总第($i+ 3$)行第$j$列的整数为$F_{i,j+i}$。($1≤i&lt;2^N，1≤j≤2^N–i)$</p><p>所有变量的含义可以参见题目描述。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输出</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>输出一个整数，表示NS中学支付给网络公司的最小总费用。(单位:元)<br></p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">样例</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<h4>样例输入 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>2
1 0 1 0
2 2 10 9
10 1 2
2 1
3</span></div></code></pre>
							</div>
							<h4>样例输出 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>8</span></div></code></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">提示</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>【样例说明】<br></p><p>将1号用户的付费方式由B改为A，NS中学支付给网络公司的费用达到最小。<br></p><p>【数据规模和约定】<br></p><p>40%的数据中$N≤4$;<br>80%的数据中$N≤7$;<br>100%的数据中$N≤10，0≤F_{i,j}≤500，0≤C_i≤500 000$。<br></p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>