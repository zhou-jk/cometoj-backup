<html>

<head>
	<meta charset="utf-8" />
	<link rel="icon" href="../image/favicon.ico" sizes="32x32" />
	<link rel="icon" href="../image/favicon.ico" sizes="192x192" />
	<link rel="stylesheet" type="text/css" href="../static/semantic.min.css">
	<script src="../static/jquery.min.js" type="text/javascript"></script>
	<script src="../static/semantic.min.js" type="text/javascript"></script>
	<title>[NOI2019Day2-B]斗主地</title>
	<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\(', '\)']]
  },
  svg: {
    fontCache: 'global'
  }
};
	</script>
	<script type="text/javascript" id="MathJax-script" async src="../static/es5/tex-svg.js"></script>
</head>

<body>
	<div class="ui three item menu"><a class="header item" href="../index.html"><img src="../image/favicon.ico"> Comet OJ</a>
	</div>
	<div class="ui main container">
		<div class="ui center aligned grid">
			<div class="row">
				<h1 class="ui header">C0486 [NOI2019Day2-B]斗主地</h1>
			</div>
				<div class="row" style="margin-top: -15px"><span class="ui label">内存限制：512 MB</span> <span class="ui label">时间限制：4000 ms</span></div>
		</div>
		<div class="ui grid">
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">题目描述</h4>
					<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<p>小 S 在和小 F 玩一个叫「斗地主」的游戏。</p><p>可怜的小 S 发现自己打牌并打不过小 F，所以他想要在洗牌环节动动手脚。</p><p>一副牌一共有 $n$ 张牌，从上到下依次标号为 $1$ ~ $n$。标号为 $i$ 的牌<b>分数</b>是 $f(i)$。在本题，$f(i)$ 有且仅有两种可能：$f(i)=i$ 或 $f(i)=i^2$。</p><p>洗牌的方式和我们日常生活中的比较类似，以下我们用形式化的语言来定义：</p><p>洗牌环节一共分 $m$ 轮，这 $m$ 轮洗牌依次进行。第 $i$ 轮洗牌时：</p><ol><li>小 S 会拿出从最上面往下数的前 $A_i$ 张牌。这样这副牌就被分成了两堆：第一堆是最上面的 $A_i$ 张牌，第二堆是剩下的 $n-A_i$ 张牌，且这两堆牌内相对顺序不变。特别地，当 $A_i=n$ 或&nbsp;$A_i=0$ 时，有一堆牌是空的。</li><li>接下来对两堆牌进行合并，从而产生新的第三堆牌。当第一堆牌还剩下 $X$ 张，第二堆牌还剩下 $Y$ 张的时候，以 $\dfrac{X}{X+Y}$ 的概率取出第一堆牌的最下面的牌，并将它放入新的第三堆牌的最上面，$\dfrac{X}{X+Y}$的概率取出第二堆牌的最下面的牌，并将它放入新的第三堆牌的最上面。</li><li>重复操作 2，一直取到两堆牌都为空为止。这样我们就完成了一轮洗牌。</li></ol><p>因为洗牌过程是随机的，所以小 S 发现自己没法知道某个位置上具体是哪张牌。但小 S 想问你在经历了这 $m$ 轮洗牌后，某个位置上的牌的<b>期望分数</b>是多少。小 S 一共会问你 $Q$ 个这样的问题。</p>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输入格式</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>输入的第一行包含三个正整数 $n,m,type$，分别表示牌的数量，洗牌的轮数与 $f(i)$ 的类型。当 $type=1$ 时，$f(i)=i$。当 $type=2$ 时，$f(i)=i^2$。</p><p>接下来一行，一共 $m$ 个整数，表示 $A_1$ ~ $A_m$。</p><p>接下来一行一个正整数 $Q$，表示小 S 的询问个数。</p><p>接下来 $Q$ 行，每行一个正整数 $c_i$，表示小 S 想要知道从上往下第 $c_i$ 个位置上的牌的<b>期望分数</b>。保证 $1 \le c_i \le n$。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">输出</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>输出一共 $Q$ 行，每行一个整数，表示答案在模 $998244353$ 意义下的取值。</p><p>即设答案化为最简分式后的形式为 $\frac{a}{b}$，其中 $a$ 和 $b$ 互质。输出整数 $x$ 使得 $bx \equiv a($ mod $998244353)$ 且 $0 \le x &lt; 998244353$。可以证明这样的整数 $x$ 是唯一的。</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">样例</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<h4>样例输入 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>4 1 1
3
1
1</span></div></code></pre>
							</div>
							<h4>样例输出 1</h4>
							<div class="ui existing segment">
								<pre style="margin-top:0; margin-bottom:0;"><code class="lang-plain"><div class=content><span class=sampledata>249561090</span></div></code></pre>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="row">
				<div class="column">
					<h4 class="ui top attached block header">提示</h4>
						<div class="ui bottom attached segment font-content">
						<div style="position: relative; overflow: hidden;">
							<div class=content>
								<p>【样例说明】</p><p>有 $\frac{1}{4}$ 的概率从上到下的最终结果是 $\{1,2,3,4\}$。</p><p>有&nbsp;$\frac{1}{4}$ 的概率从上到下的最终结果是 $\{1,2,4,3\}$。</p><p>有&nbsp;$\frac{1}{4}$ 的概率从上到下的最终结果是 $\{1,4,2,3\}$。</p><p>有&nbsp;$\frac{1}{4}$ 的概率从上到下的最终结果是 $\{4,1,2,3\}$。</p><p>所以最终有&nbsp;$\frac{1}{4}$ 的概率第一个位置是 $4$，有&nbsp;$\frac{3}{4}$ 的概率第一个位置是 $1$，所以第一个位置的期望分数是 $\frac{7}{4}$。</p><p>为了帮助你们更直观地了解洗牌的过程，我们在下面画出了结果是 $\{1,4,2,3\}$ 的过程：</p><p><img alt="image.png" src="../upload/39b57562b2.png" width="712" height="417"><br></p><p>【数据范围与提示】</p><p>对于所有的测试点：$3 \le n \le 10^7，1 \le m,Q \le 5 \times 10^5，0 \le A_i \le n，type \in \{1,2\}$。</p><p>每个测试点的具体限制见下表：</p><p><img alt="image.png" src="../upload/13fe4807a7.png" width="381" height="308"><br></p><p>请注意我们<b>并没有保证</b>$Q \le n$。</p><p>这里我们给出离散型随机变量 $X$ 的期望 $\mathbb{E}[x]$ 的定义：</p><p>设离散随机变量 $X$ 的可能值是 $X_1,X_2,\cdots,X_k，Pr[X_1],Pr[X_2],\cdots,Pr[X_k]$，为 $X$ 取对应值的概率。则 $X$ 的期望为</p><p>$\mathbb{E}[x] = \sum^k_{i=1}X_iPr[X_i]$</p>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>

</html>